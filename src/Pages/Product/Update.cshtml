@page "{id}"
@using ContosoCrafts.WebSite.Services
@using ContosoCrafts.WebSite.Models
@inject JsonFileProductService ProductService
@model ContosoCrafts.WebSite.Pages.Product.UpdateModel

@{
    ViewData["Title"] = "Edit page";
}

<div class="hero-read-container">
    <div class="hero-read-card">
        <h1 class="hero-read-title">Edit superhero</h1>

        <div class="hero-read-content">
            <!-- Image -->
            <img class="hero-update-image" src="@Model.Product.ImageUrl" alt="Image for @Model.Product.Title" />

            <!-- Fields to fill -->
            <div class="hero-read-details">
                <p><strong>Fields marked with (<span class="text-danger">*</span>) are required</strong></p>
                <form method="post" class="update-form">
                    <input type="hidden" asp-for="Product.Id" />

                    <!-- Superhero Name -->
                    <div class="form-group">
                        <div class="label-row">
                            <label asp-for="Product.Title"><strong>Superhero Name (<span class="text-danger">*</span>)</strong></label>
                        </div>
                        <span asp-validation-for="Product.Title" class="text-danger"></span>
                        <input asp-for="Product.Title" class="form-control" />
                    </div>

                    <!-- Full Name -->
                    <div class="form-group">
                        <div class="label-row">
                            <label asp-for="Product.Fullname"><strong>Fullname (Optional)</strong></label>
                        </div>
                        <span asp-validation-for="Product.Fullname" class="text-danger"></span>
                        <input asp-for="Product.Fullname" class="form-control" />
                    </div>

                    <!-- Gender Dropdown -->
                    <div class="form-group">
                        <div class="label-row">
                            <label asp-for="Product.Gender"><strong>Gender (<span class="text-danger">*</span>)</strong></label>
                        </div>
                        <span asp-validation-for="Product.Gender" class="text-danger"></span>
                        <select asp-for="Product.Gender" class="form-control">
                            <option value="">-- Select Gender --</option>
                            <option value="Male" selected="@("Male" == Model.Product.Gender)">Male</option>
                            <option value="Female" selected="@("Female" == Model.Product.Gender)">Female</option>
                            <option value="Other" selected="@("Other" == Model.Product.Gender)">Other</option>
                        </select>
                    </div>

                    <!-- Role Dropdown -->
                    <div class="form-group">
                        <div class="label-row">
                            <label asp-for="Product.Role"><strong>Role (<span class="text-danger">*</span>)</strong></label>
                        </div>
                        <span asp-validation-for="Product.Role" class="text-danger"></span>
                        <select asp-for="Product.Role" class="form-control">
                            <option value="">-- Select Role --</option>
                            <option value="Core Avenger" selected="@("Core Avenger" == Model.Product.Role)">Core Avenger</option>
                            <option value="Founding Avenger" selected="@("Founding Avenger" == Model.Product.Role)">Founding Avenger</option>
                            <option value="Mystic Defender" selected="@("Mystic Defender" == Model.Product.Role)">Mystic Defender</option>
                            <option value="Guardian" selected="@("Guardian" == Model.Product.Role)">Guardian</option>
                            <option value="Support" selected="@("Support" == Model.Product.Role)">Support</option>
                        </select>
                    </div>

                    <!-- Alignment Dropdown -->
                    <div class="form-group">
                        <div class="label-row">  
                            <label asp-for="Product.Alignment"><strong>Alignment (<span class="text-danger">*</span>)</strong></label>
                        </div>
                        <span asp-validation-for="Product.Alignment" class="text-danger"></span>
                        <select asp-for="Product.Alignment" class="form-control">
                            <option value="">-- Select Alignment --</option>
                            <option value="good" selected="@("good" == Model.Product.Alignment)">Good</option>
                            <option value="bad" selected="@("bad" == Model.Product.Alignment)">Bad</option>
                            <option value="neutral" selected="@("neutral" == Model.Product.Alignment)">Neutral</option>
                        </select>
                    </div>

                    <!-- Birthplace -->
                    <div class="form-group">
                        <div class="label-row">
                            <label asp-for="Product.Birthplace"><strong>Birthplace (Optional)</strong></label>                            
                        </div>
                        <span asp-validation-for="Product.Birthplace" class="text-danger"></span>
                        <input asp-for="Product.Birthplace" class="form-control" />
                    </div>

                    <!-- Work -->
                    <div class="form-group">
                        <div class="label-row">
                            <label asp-for="Product.Work"><strong>Work (Optional)</strong></label>                            
                        </div>
                        <span asp-validation-for="Product.Work" class="text-danger"></span>
                        <input asp-for="Product.Work" class="form-control" />
                    </div>

                    <!-- First Appearance -->
                    <div class="form-group">
                        <div class="label-row">                            
                            <label asp-for="Product.FirstAppear"><strong>First Appearance (Optional)</strong></label>
                        </div>
                        <span asp-validation-for="Product.FirstAppear" class="text-danger"></span>                        
                        <input asp-for="Product.FirstAppear" class="form-control" />
                    </div>

                    <!-- Image URL -->
                    <div class="form-group">
                        <div class="label-row">
                            <label asp-for="Product.ImageUrl"><strong>Image URL (<span class="text-danger">*</span>)</strong></label>
                        </div>
                        <span asp-validation-for="Product.ImageUrl" class="text-danger"></span>
                        <input asp-for="Product.ImageUrl" class="form-control" />
                    </div>

                    <!-- Power statistics title -->
                    <h2 class="hero-read-title">Power Statistics</h2>

                    <!-- Intelligence -->
                    <div class="form-group">
                        <div class="label-row">
                            <label asp-for="Product.Intelligence"><strong>Intelligence (<span class="text-danger">*</span>)</strong></label>
                            <span asp-validation-for="Product.Intelligence" class="text-danger"></span>
                        </div>
                        <div class="slider-container">
                            <input asp-for="Product.Intelligence"
                                   type="range"
                                   min="0"
                                   max="100"
                                   class="form-range slider"
                                   id="Intelligence-slider" />
                            <span class="slider-values" id="Intelligence-value">
                                @Model.Product.Intelligence
                            </span>
                        </div>
                    </div>

                    <!-- Strength -->
                    <div class="form-group">
                        <div class="label-row">
                            <label asp-for="Product.Strength"><strong>Strength (<span class="text-danger">*</span>)</strong></label>
                            <span asp-validation-for="Product.Strength" class="text-danger"></span>
                        </div>
                        <div class="slider-container">
                            <input asp-for="Product.Strength"
                                   type="range"
                                   min="0"
                                   max="100"
                                   class="form-range slider"
                                   id="Strength-slider" />
                            <span class="slider-values" id="Strength-value">
                                @Model.Product.Strength
                            </span>
                        </div>
                    </div>

                    <!-- Speed -->
                    <div class="form-group">
                        <div class="label-row">
                            <label asp-for="Product.Speed"><strong>Speed (<span class="text-danger">*</span>)</strong></label>
                            <span asp-validation-for="Product.Speed" class="text-danger"></span>
                        </div>
                        <div class="slider-container">
                            <input asp-for="Product.Speed"
                                   type="range"
                                   min="0"
                                   max="100"
                                   class="form-range slider"
                                   id="Speed-slider" />
                            <span class="slider-values" id="Speed-value">
                                @Model.Product.Speed
                            </span>
                        </div>
                    </div>

                    <!-- Durability -->
                    <div class="form-group">
                        <div class="label-row">
                            <label asp-for="Product.Durability"><strong>Durability (<span class="text-danger">*</span>)</strong></label>
                            <span asp-validation-for="Product.Durability" class="text-danger"></span>
                        </div>
                        <div class="slider-container">
                            <input asp-for="Product.Durability"
                                   type="range"
                                   min="0"
                                   max="100"
                                   class="form-range slider"
                                   id="Durability-slider" />
                            <span class="slider-values" id="Durability-value">
                                @Model.Product.Durability
                            </span>
                        </div>
                    </div>

                    <!-- Power -->
                    <div class="form-group">
                        <div class="label-row">
                            <label asp-for="Product.Power"><strong>Power (<span class="text-danger">*</span>)</strong></label>
                            <span asp-validation-for="Product.Power" class="text-danger"></span>
                        </div>
                        <div class="slider-container">
                            <input asp-for="Product.Power"
                                   type="range"
                                   min="0"
                                   max="100"
                                   class="form-range slider"
                                   id="Power-slider" />
                            <span class="slider-values" id="Power-value">
                                @Model.Product.Power
                            </span>
                        </div>
                    </div>

                    <!-- Combat -->
                    <div class="form-group">
                        <div class="label-row">
                            <label asp-for="Product.Combat"><strong>Combat (<span class="text-danger">*</span>)</strong></label>
                            <span asp-validation-for="Product.Combat" class="text-danger"></span>
                        </div>
                        <div class="slider-container">
                            <input asp-for="Product.Combat"
                                   type="range"
                                   min="0"
                                   max="100"
                                   class="form-range slider"
                                   id="Combat-slider" />
                            <span class="slider-values" id="Combat-value">
                                @Model.Product.Combat
                            </span>
                        </div>
                    </div>

                    <div class="form-actions">
                        <button type="submit" class="btn btn-primary">Update</button>
                        <a asp-page="./Index" asp-route-id="@Model.Product.Id" class="btn btn-secondary">Cancel</a>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>

<script>
    /// <summary>
    /// Initializes all sliders on the page once the DOM is loaded.
    /// </summary>
    function initializeSliders()
    {
        // Get all slider input elements
        var sliders = document.querySelectorAll('.slider');

        // Setup each slider individually
        for (var i = 0; i < sliders.length; i++)
        {
            setupSlider(sliders[i]);
        }
    }

    /// <summary>
    /// Sets up a single slider: initializes its display and attaches an input listener.
    /// </summary>
    /// <param name="slider">The slider input element.</param>
    function setupSlider(slider)
    {
        // Find the container element for this slider
        var container = slider.closest('.slider-container');

        // Find the span element that displays the slider’s current value
        var display = container.querySelector('.slider-values');

        // Initialize the display with the slider’s starting value
        display.textContent = slider.value;

        // Update the display whenever the slider value changes
        slider.addEventListener('input', function onSliderInput()
        {
            display.textContent = slider.value;
        });
    }

    /// <summary>
    /// Entry point: wait for DOMContentLoaded then initialize sliders.
    /// </summary>
    document.addEventListener('DOMContentLoaded', function onDocumentReady()
    {
        initializeSliders();
    });
</script>