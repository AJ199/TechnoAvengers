@page
@model ContosoCrafts.WebSite.Pages.DiscoverModel
@{
    ViewData["Title"] = "Discover Your Avenger";
}

<div class="container mt-5 text-white text-center animate__animated animate__fadeIn">
    <h1 class="mb-4 hero-text">🧠 Discover Your Inner Avenger</h1>

    <form id="quizForm" class="quiz-form text-start" onsubmit="return handleQuiz(event)">
        <div class="quiz-question">
            <p><i class="fas fa-bolt"></i> <strong>1. What drives you the most?</strong></p>
            <label><input type="radio" name="q1" value="ironman" required> Innovation</label><br />
            <label><input type="radio" name="q1" value="thor"> Honor</label><br />
            <label><input type="radio" name="q1" value="blackwidow"> Strategy</label><br />
            <label><input type="radio" name="q1" value="captainmarvel"> Power</label>
        </div>

        <div class="quiz-question">
            <p><i class="fas fa-crosshairs"></i> <strong>2. Preferred weapon?</strong></p>
            <label><input type="radio" name="q2" value="thor" required> Hammer</label><br />
            <label><input type="radio" name="q2" value="blackwidow"> Pistols</label><br />
            <label><input type="radio" name="q2" value="captainmarvel"> Energy Blasts</label><br />
            <label><input type="radio" name="q2" value="ironman"> High-Tech Armor</label>
        </div>

        <div class="quiz-question">
            <p><i class="fas fa-chess-king"></i> <strong>3. Leadership style?</strong></p>
            <label><input type="radio" name="q3" value="ironman" required> Lead with logic</label><br />
            <label><input type="radio" name="q3" value="thor"> Lead by example</label><br />
            <label><input type="radio" name="q3" value="blackwidow"> Behind the scenes</label><br />
            <label><input type="radio" name="q3" value="captainmarvel"> Inspire from the front</label>
        </div>

        <div class="quiz-question">
            <p><i class="fas fa-dumbbell"></i> <strong>4. Biggest strength?</strong></p>
            <label><input type="radio" name="q4" value="blackwidow" required> Intelligence & Tactics</label><br />
            <label><input type="radio" name="q4" value="thor"> Raw Power</label><br />
            <label><input type="radio" name="q4" value="captainmarvel"> Cosmic Energy</label><br />
            <label><input type="radio" name="q4" value="ironman"> Invention & Tech</label>
        </div>

        <div class="quiz-question">
            <p><i class="fas fa-user-shield"></i> <strong>5. Who do you trust most?</strong></p>
            <label><input type="radio" name="q5" value="captainmarvel" required> Yourself</label><br />
            <label><input type="radio" name="q5" value="blackwidow"> Your team</label><br />
            <label><input type="radio" name="q5" value="thor"> Your family</label><br />
            <label><input type="radio" name="q5" value="ironman"> Your AI system</label>
        </div>

        <div class="d-flex justify-content-center gap-3 mt-4">
            <button type="submit" class="btn btn-danger btn-lg animate__animated animate__pulse"><i class="fas fa-fire"></i> Reveal My Avenger</button>
            <button type="button" class="btn btn-secondary btn-lg" onclick="resetQuiz()"><i class="fas fa-undo-alt"></i> Retake</button>
        </div>
    </form>

    <!-- Modal-style result box -->
    <div id="quizModal" class="popup-overlay d-none">
        <div class="popup-modal animate__animated animate__zoomIn">
            <div class="popup-message" id="resultText"></div>
            <button class="popup-close" onclick="closeModal()">Close</button>
        </div>
    </div>
</div>

@section Scripts {
    <script>
        const heroAssets = {
            ironman: { name: "Iron Man 🧠" },
            thor: { name: "Thor ⚡" },
            blackwidow: { name: "Black Widow 🕵️" },
            captainmarvel: { name: "Captain Marvel 🌟" }
        };

        function handleQuiz(e) {
            e.preventDefault();
            const form = new FormData(document.getElementById('quizForm'));
            const scores = { ironman: 0, thor: 0, blackwidow: 0, captainmarvel: 0 };

            for (const [, value] of form.entries()) { scores[value]++; }
            const result = Object.keys(scores).reduce((a, b) => scores[a] > scores[b] ? a : b);

            document.getElementById("resultText").innerHTML =
                `<strong>You are:</strong> ${heroAssets[result].name}<br>Your traits align with ${heroAssets[result].name.split(" ")[0]}.`;

            document.getElementById("quizModal").classList.remove("d-none");
        }

        function closeModal() {
            document.getElementById("quizModal").classList.add("d-none");
        }

        function resetQuiz() {
            document.getElementById("quizForm").reset();
            closeModal();
        }
    </script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css" />
}
